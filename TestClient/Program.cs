using FrameworkData;
using FrameworkData.Settings;
using System;
using System.Collections.Generic;
using System.Linq;
using System.ServiceModel;
using System.Text;
using System.Threading;
using System.Threading.Tasks;

namespace TestClient
{
	class Program
	{

		static List<string> folders = new List<string>() { "F60D3B49CB4E8432E3844C8580386064","38F8ECF71A49759FB31B6F4DF2621E23","9D2F75520C3526C7A4BBDC9FD3EAFD6F","57D69779D4751774C8095DC864A11196","4B018D9E8A57FE291F5D7CF8A0C8FF43","B0A673DA3CB462ED92544F7022B40C4B","155F6A844CFB6FDB1DF8F3F7E2CBDEBD","B7992A2C98517D7E288347F83C17FE05","EADA756059C57B7A96216700EA2EB41B","011ADB408D01814DDE7EDEEFEA2DA425","B15293974C69FAEC3D43DB231DF17BFA","7F42D271205D71D1688A91B197C68D4F","749ADA5481E69ED2661B4CAD9C568952","ED1731F398B0CBB045C2AD848A1E0254","350A6089C3EA6B45A399E4516A960248","59DD14271D6D59D6B66B600B2C9F29D2","E3EB358E883B6F5667A61A3480790A63","2BB2980E4D54BA7445A5775E6A707114","4A4BBBBA01045A94BE8944BA2FD53A84","2F5A8B1F662BAEBE8B59232FFEAFAABC","5890DEB8DC777A90B6F036EFB6DA01BA","7F0E06D42E9F46784052817477FE49BB","BEAE440DC4CF7F47507640A013001C8D","0FCA0054B016DE5060E42B22CF05689B","D71EB1B6048317C02D55E9DDA779894D","C4F486A54A97637B90A2A0D3AB5E9DEA","61CF6985A78A6D45A756FB03D7DCE608","64CCEAA5CA02EA94EC851CED9097505C","D48B886EA7280FDE2F37ED06EF3E3984","571F43A03A0B63630C1437E835500052","860B82F9342CD5F0902EC60C13D1CA77","FF8D0663A979204E81E45C95D3ADFC99","8A4CFEAA7B0E54778206A5AA3B4D0A7F","772912419689765247B6C96AD6026083","2CAE47389ECC27967F672E37132290CB","C68E9F5AD30D2AC5862BECB34BAC3AA3","568DBED1242DB0A01D1DC4C932818211","CE0056DE26A0631232C103266F4B8075","30B906F3C24CEA8566C8E8786D0868E4","740710E3332E5ECC2F76BBE90EA9F759","102CDA1CC8BFABB35F70012C2C284C82","27010641B4868D90600D9D6CDAC7A847","981DC05BDE66E4A37B391971BD33268A","979E75421C4151874DEFF52C14B52F01","4510C64E66A05EDB5BC955FC5A1A2727","B2A2A3F7FB32406C3AECB15207A979B3","AFDAB41EB237CC5DC8ACDB3C509E9B1E","C467DB7D000E0FC88D57C73D94F99F14","D321F85951B78C47A769860D958E7518","FF2B70284F713327B2B68E40609BD3A0","4F64305DB4CE1C5B33BBC26CDF0C8B10","728E2D6B7066E3A54D6EEBA121860C6A","792C483FE61DD5E9AA84A7C0308BD2EB","9872DD91B9D083FEB40B88C43A7908BF","079FC5FEE00E91185462ADF23A51CB4D","A635A993D02E545687CBAF8D704B507C","C66C0EEF60828DFC7EAD16835EEDEA90","0B5A0637701C6C6EF8A7C810420096A4","A61073F529D81C477F3433F90CA9BDAB","494A8825E2271515F25772BE11C3600E","59302630C219A9E9902649078D039D74","7B18D73612DED8B15E269E8A5D9F22A9","36117E156A237D8F41C1D9E8A0AF8E23","9EAE89C08D59B080AD8EFCD7B6CD3A91","168AE837B35E468D3556DBE2E2D64A8B","6E9151DDC42F39A6C31FF3BBA0039BE0","1F6A938A22D648CA5BE66F60DE7CEAB3","D3E1DE771ABC735D2BD281FBD1432251","EB5BA73867AF0BC9619AFD2C2E1B9D62","DAAD353DBFCDD946B00C57A224981749","FBF1CDD354BC9DCEBBECB7B98F365329","70C98270EEF89435B124B3C1DA0B7C6E","BB10C4E33C29BB1A1416FBFA9774462E","3B939684451DB8784AE14BBEB0C8439D","1A381E98F8903F0F72A48338692386DD","A065914FC0D991943DD977A0971955C1","EA5F2F5001842DBA4FFB124569E12655","D405DFAE1E299E946256E4CD532162CE","5C9C5D12CBF35DC6A62ED9662534162A","24CACC06A372D4979C57D5D992D10E48","33A90E81939FD3430A2F6530F222DED3","F88E40DC50CFAA04439B1EAF0DD5E5B2","F84122977335B6947878F03D95228194","0C3F668C01A8EBD12278966664DAE88E","FB81D89C4A0E74568A7BF74B9912655C","99745DB78DC98D1C7CE90CCF40A70016","981309DFEA000548DB1CEDC09D0E46B1","6F9E78DF5F3CF2AC8825BDC57B2C3C07","4F27F3FEE92B82CBE341EC4A7DA72D92","72038DEF6F64C7A09D5A4AACC04C6BEB","BF645C441A5B60F57A68001E23E541B8","B049FB48D92A3B73A67417001D1E7565","D67798D9814B7E2C6C8E405B50E08404","F117FA44B7DBAA1C586CCBBB0C36B49F","81F4E846E59B9E2BDF422CA5404C6978","ADF285295A1A437E7709AAFD8C319EA6","771A016EF1BCC461B58E0D4CE512A6D3","2551E288CE82786EA83DDE91DBAA7BAB","A7D3DEEEF4460B386C43F5939B29728B","EB3F6169945DC0CDE165D07C7683084C","B3043C6E10DEFA13D86690E01D2704B6","EFD0DC48F2FF122381109F633D4AE0B7","42F411E678AC8BF95E44992EC020B242","E9BE7FDC4D338003BA53073AFA9676D7","A3862729C18B4BEF19E815D8F870C19F","58AC07AFBAA691DF132587A27638801E","FFD75B7E3C2EA01DCDC78A47B390ACAB","A62073295B60A26C884A196BF2376EBF","89892C9787C6F7BBE68EE7C84F786429","8A59B89C34AF66E32155DBDBBDF7BD61","06DC7DC2DB414395903B91DEAE9E5A96","B6174B15561CF21420740A784D72B8DE","1ECAC63B8C059CB6117DDF884CC7D420","9616EC2E3D390A122C0ABDF14CEAF8FB","4E10BB7DD5C1CAB8DFC94E3D75CA4B4A","C58F2D4FFB94FFD5119DB2B59F1E30DD","A7798B2F2C70DA469C90677997D5D281","5CA9C30EEE768E5C2567339F6E98AD0B","0D127BDC22BA406470B5E08CF245A55B","AEC0B55A725AAF944EDAA212B09A70DA","AE25F32BCDABD4895E8A34577A9A00B6","F3EB237AB5C81B8E5DAFA1F0AEF5AEF5","D920280930507DC61D4B7E623458A976","A74DF9281DA678B65DCCEBF8B70F17F3","6ADAF1E96B7F038C6EB30D85FF8A6F03","4F56649DF2B0816B995093AD7B76AD27","C8B0BA638849E38FFDC4F3D3DB60A3A7","E6DB2C659180111A7DA7D155941E146E","4CA4F6CEF5A38633FB55013E2BFF183F","9DC4519461A755DCE9F0E3732454FB39","3122C4F49EF812DA68589D76BC0A1345","B80C053AC76B74A0651BB714AD21F1CB","F8FFBC58F53645B35ED3CD81743B0142","C85A05616AFC276A39C9F25832B5AD76","2532781ABB4C0817505381083E435F76","0CD25E9FFDDE9B8B80E85F2814A9B1D9","C011C501765C98C13CD6FDAB1E940B8A","AED422F8B07DB48CE2186042DA81AD0F","C870FE8F12CBF368DFC0535AE2BF18C0","CE9C5100AD358587D05AC21E20EEB8FB","6C7AF12EADE912F2D59637DB5D1625CD","E5BE80E9FF1977E23535D0555F13F334","9679FA17AD048654C747D995AAE959FF","8D1E66839D5248A34BA4DEBDF9A78815","45A3C4D5B8080B7D3690B20722715A3A","985EDFB3F711B3837589ACC827641723","DB084A5F1382F4472AD25F890F49BF75","69D00A6ECFF9357E115DB352B2FEEEF8","04CA55A802CEB8F2D84C67F94767A5DF","B9FE3C01C720E1A6A146050C4BE46C57","05A505422447C819EEC3B3A7A39174FE","BFD09A96161F8478060298C6772D21BA","026EC10FCC599FEA402661375109EAB0","648F6143F98281A2FC19B73D58A7C46C","EDA9BCBAB20C0E750DE4393D9AF8042A","18E912A9727AC23F4B22750D544D8B29","27FB1607D02CAEE9A28368845B294C28","8BF136E569689C4B346321CC2CC48B20","A27B420B6AF4705EE5C02DD011603A0A","2EF8CFCC91FE436E7A99F67FA0EC1150","C7FF28345B0791E8B4C4E8CDCEDC5361","35EE9C93E1956F170BA260ECB0BCDF75","F168184923F8EBA0A95F4F877ACAC4DA","24CC4869E61850052C30F99D91CA3D5C","7ADEB6F348D1D664EAB672BB8071A42C","32AB7BFD1A502FBB939A8FD24C58DA44","1F7892750EB42088EE6D1F78E11CC043","57CC11FB6B1ADB95656AC90FC892EE70","340BDC5E1892D9EF5D5DF06B84D5C8F0","96D20A5DC197F9130E52E99550A862F8","C37060D94C3B064B612F9069F19E124B","920F5A6E5329ED6E2DE2ED096CEBB5FE","3F2C8E70A1E088A85E228CE07EC3129A","A92A69BF3C9E185798E18C106B75D014","48404ED3BE7A167114C8B21C3D4F15A4","99F97F9142416E4750ED8BD026DD4C92","0BF1F0E74BA8860E88A2BBECA2B5989E","A82A6CAC351395ECF0E575A9AF6759D4","FCD3BF5AA05BD47D2E584D76FEF94BED","16649E66A397F6938842E09C7E564E5F","17EE35DD8D7E278FD651083C87688077","DAFDC4343DE73AA950D0F613D0A3A76C","4026CCF45C338D7F6F3F604CCC70F38C","94200CB1D9E3EC9415FA18E050FBFA73","68B7FBD48009B9D20AF166E4F3EC223F","619B9B95FD310E8C61B840F572EC0A33","6259F5A1FEE1B85A81C98925F2477A87","23F3FF6C53C750494E57735BB5F4D37D","9F263B93320351C5F0FED145118DE847","2F0495E76C5D6811C2BF45ABE83F5240","4B70BFACA3A65D9C63936CA962411CF3","7554F9F0F3F63E3B4262AA95D2CF104C","24FDB0B180EDB8214E39076376BF4876","DBCB290091C64F4C061AB423CDF8103F","0D97A8DB359D21F64AF3DF6C9F7F50B6","BE3C6DA9718B9280075967E1A8CE91BB","FB9FB703147EA9518FF4AF9685A3B467","4819B703088896BF426213C236C32723","E8E7B6855A2928920BAA579C4BC7B93C","84A843129E701610DEF9F24F1873CCD3","05A68084BE95A4E5AAD8C2B1FAB96C62","93CDFAF2370FA1640275E591E198CA8B","7C8F10ED105F71C806CAE2CE9268BF4A","6B9E42E417588B8466F7688411C40317","7C7DFFF1F7948F1A49F6FBCDCD311FB3","F85473A368EBE2F5B6DAA4922CF279E2","9731CBEB4A5F7D01955FF6CA798F6E21","F3081D553633CB51E50F3F6E54612D2A","D76FF1E68D1EAF877C17397E52974474","04300197A2C818897F2D93BB8ABBCCD1","88E0F2E6A0F510FE2F453FDF5AB5DB64","8E347A02AEF2AB5BA12F60AE214F0F5D","F32B2608983C975B148E537D10622AF8","590B92E541AF563DA445CA7CD1F598A4","E4D4510FC4D4587768C5433962D3B043","67E39FFC7DC48699FD763617196A97EA","BCE06D988A4EE280C71EA7B816FAAA4D","5CF657A92268264FE8065EFDF393661B","961192C1D2FACE10B791F75809163AF6","A0157D830820863867C3E65298F4F2B3","3B9117E99E613D8AC6F3E7D2203FABB9","DC9FE74AA76D51F5B5B1A212E089902B","5B4DA5FE79742B997BF5955C4A8B9193","C4EAB86B365A15FB4669C28AA647997C","52F7C5E0E4800AC41C6A5A7C822317D4","305B8556618165D0BC9E588D439510FC","238C9336676B9E38C8B33E1598F6FAF0","64D24E4C9AD7B51B7EFF5C2969C017E1","D70AADB8EE35D79BDBDB15F4EA5094C2","B0D0D445520103DDBF6756F2FC2AE03B","0A6D881419C052BAF1F0F10D01495603","4C760F983A92FBC91B498C3B1094008E","57D346975B661C5FB587B353284B6675","F102D0ECF388DF0F7EAB679C835437E9","37C508E9A39B9D7BD85D8D67E5D01D91","27D891E5F08DC6D77E15B1E781345080","8E006920AFA7A687D1861F0694B7E64A","847617D66DE99C8B7D2F3BA720CB2835","EF4CA93E49B9E00B890C397DB5A5DA2F","EEF23C96B90C04674DC11A4E731E9AD8","23008DA5C86A0578CCB1B9219402D5AD","FC0DD1EA2CF2E4928956FCD160F6980B","684AD59F5C971B1C4F6AD3B5985B09E5","8B9E18C638600BBA48AD52C0E6509794","372CD2A77E7FD96E2C40407FB5B77F10","E620BFDD21B5445DF8043B7EBF15F902","3121D47D259F2A3B9BE4BEB13C539CAD","4A6BB0AECF9C6D01C3B9DFB13D533F51","C79AB83D62E68F83B3934AE679162919","E8291A25422BEBB8E5165104C6F88083","8418E4FE864F9314F00F118BECC43D1F","E9FCC5A6B257FE9BE8A494A2E7B4B76D","2533DEEF9825314B0BD7FA2085263505","AF1E6D3946B4E5BB0A8C8471251F2AD1","A361E640EDEE46CBDCFDCD9C6342C1C1","A52A7D80158094BE09A53E357CBDC438","63B3CDDCC81FA6766CB27F0663FC8FB7","58E6A320CFE600D153EDBC878525A0FA","0D3DEE09440B8C7AA6205D51046F46D0","8A4D55DF8468D6E385826F7946CF7987","3F8D10541599450971D1C552101D676A","97F4172B77F93DC997DC6036E54A07CB","4545609E1913215C64AC332F636ED9D9","90C123C37DB07BDE716DFE26DCBED3A0","52A79856220E51A06FD961B24F82D36C","A55589A88816A37DB9EF6F932C9AE81E","724C216716C52FFDD7F59E3EC9C0D215","1E5156E222282CC6CD2B5AE32A0878AE","CE9C4C0DE4A2E23BDF5A4C85BCF50589","88C823260E983B3E10ADC5F740A7A3DC","4D3F6F3101E01E76C0904420541BCA73","8E63FA15767C0DA7539DEDFD70161ABB","C6710F27A8466BEA3FEACB120BC63726","A4DC45652399102DE9757C7789ACF2DE","30973634648D85E6EDA72EB768972DE0","B4C4A045983F71D670AF4F5B3E5C4CB4","4112F25769281C0969013FD281EC4C16","3B513C215E464CFB6654F6369F708B40","C9AA418E403FF1D23C72A5FF12935D5C","4857A283C73D199396B8104D697D26F3","2E5B312B9A310788779CDA915A119F83","41FA6452CABC007A448A51A7D72CDD15","863A0F9F17973EA11860178D8507243B","C8ECFADAD654140E8566810872BC73B9","067511A515A9DAB0A84003F882883106","91B1CCF749A760B92DC6249CF42CF747","310A3DC68EF80EA9E17166592F942697","C07BDC71A6FF1E5F990D7EB976F1180F","70546C93B679F71B0CC647EF7990626F","4344723FE058D528258CB833CD97E4C8","843749B31EEE6621B7B095E931D67620","F50C7F48C2E1D2AC2D90D62404DF21F7","C729CDD383DC789253E5F160404AA838","467699E93C29088F5128E061434FAC94","66995111E24243DC37CECE902D177001","949E194123828415871956A71F87C1FE","C964660F73C4D755BBD83D91B339AEC4","62BDB63C7EDE57BD70BE9F496BFD52B7","C7AA02CCA429CCA3EDD1B37565541D76","B32B909EEF4FA530C2BFB86A87A45A05","94AFD4608769D05F500EB78580579E74","295F41F6592F4A7D7D292D960FEBEA0E","F7D5E92FAD440360E389DCE181F4C51E","DBBCCE6AC462E5859974BC505648FFB1","211BBED3AF01BEC39A96CC391A17C076","F777524A1F528040C7CADEB87DC345F5","1997AE21EB8F8284D1643C16B67257E0","A1D572DF9AC91F89F5C13B36E83E3198","F1C39A47604A445D1DC3A5304FEBEB52","829A48195FF497F1C7FEE7FC9A0898A5","CC1324955A0D374839E8F45F756DC90D","48D91996BA69AC61648CC73CCCC2910F","7ACE936A0A5906A854E5CAE0292752FB","9B4D969C40D1F02CD215D73B4BFD0096","2FEAEB7E4541FDE6C6D8D93641442E60","CF93F550EC65A2EF4B75E9B9C5E8731A","E373CA3C14ADF9844D2BCD1898478BD1","D56E458919D4C7A62245AA534B687967","754EA1CB34335193916FB8B364DE3834","20A2FB11371441A98A9EC88B36E62FD4","F7880F4E683495AFF60DADD3DD9E102C","BF7194B41E5168C6AFAE2C47EC6A9091","00088AF6419E6F909DCD13AF5E2DAB98","E8257FA77E7A6D49A65928E6EA6FF023","8A64408816CD0CFC00D1ED3D6438DBB0","47DE422122CFED4C1E9D1AC9BC9F9318","F665BFBFF3C660EC22E413F51003D005","A75B015669D6D755DC98E56C035FFBDB","ED564A469A021812814D92FF972B179A","23E85B9539CAC785049CD063E355BDA0","EC9F5F6E251EECCF24969A2AA678ED9E","5062050BA3DB0D0E126A49C128532DC2","C9630C6CF6614F26939DD84AB8422D5A","43513AECD4BF6DE361EE5A1FEC782B60","919E5217AB804368582C70DA4CE084E4","39723C92A2A9DB0AFFB1139E0B3DE143","56D4ED4DBA11A557E55B1A95D950E2C5","79759C4E975A6FF5CF03A5BA02C304C5","B51B5577CDAF44EA2F945EDAA1958446" };
		static ChannelFactory<IStorageDataDriveService> pipeConnection;
		static void Main(string[] args)
		{
			/*ChannelFactory<IMessagebleService> httpFactory =
			  new ChannelFactory<IMessagebleService>(
				new BasicHttpBinding(),
				new EndpointAddress(
				  "http://localhost:8000/Reverse"));*/
			

			pipeConnection = StorageServicePipeAccessPoint.GetConnection();
			AppDomain.CurrentDomain.ProcessExit += CurrentDomain_ProcessExit;
			AppDomain.CurrentDomain.UnhandledException += CurrentDomain_UnhandledException;
			//IMessagebleService httpProxy = httpFactory.CreateChannel();

			IStorageDataDriveService chanell = pipeConnection.CreateChannel();

			Console.ReadKey();
			foreach (var f in folders)
			{
				var items = chanell.GetConentOf(f);
				foreach (var item in items)
				Console.WriteLine("pipe: " + item.ToString());
				
			}
			Console.WriteLine("completed");
			Console.ReadKey();
		}

		private static void CurrentDomain_UnhandledException(object sender, UnhandledExceptionEventArgs e)
		{
			pipeConnection?.Close();
		}

		private static void CurrentDomain_ProcessExit(object sender, EventArgs e)
		{
			pipeConnection?.Close();
		}
	}
}
